package evm

import (
	"encoding/binary"

	"gno.land/p/onbloc/uint256"
)

// for `gno run`
func main() {
	caller := Account{
		Gas: 3000,
	}

	// function a() public pure returns(uint8) {
	//     return 84;
	// }
	res, _, err := caller.Call(nil, -1, uint256.NewUint(12), "a()", "6080604052348015600f57600080fd5b506004361060285760003560e01c80630dbe671f14602d575b600080fd5b60336047565b604051603e9190606a565b60405180910390f35b60006054905090565b600060ff82169050919050565b6064816050565b82525050565b6000602082019050607d6000830184605d565b9291505056fea2646970667358221220368126a6b73d43aa76aadbfe86261dc0527ac2037fbd80bdcd4bee7210eef92e64736f6c634300081b0033")
	if err != nil {
		println(err)
		return
	}
	println(binary.BigEndian.Uint64(res[len(res)-8:len(res)]), caller.Gas)

	// function succ(uint256 n) public pure returns(uint256) {
	//     return n + 1;
	// }
	res, _, err = caller.Call(nil, -1, uint256.NewUint(12), "succ(uint256)", "608060405234801561001057600080fd5b506004361061002b5760003560e01c8063b6bb186414610030575b600080fd5b61004a600480360381019061004591906100b1565b610060565b60405161005791906100ed565b60405180910390f35b600060018261006f9190610137565b9050919050565b600080fd5b6000819050919050565b61008e8161007b565b811461009957600080fd5b50565b6000813590506100ab81610085565b92915050565b6000602082840312156100c7576100c6610076565b5b60006100d58482850161009c565b91505092915050565b6100e78161007b565b82525050565b600060208201905061010260008301846100de565b92915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b60006101428261007b565b915061014d8361007b565b925082820190508082111561016557610164610108565b5b9291505056fea264697066735822122009693ddc60eb08f1b3bc77e7fc3f3c589f87b9a9356271abaf69b9c84162550164736f6c634300081b0033",
		uint256.NewUint(42),
	)
	if err != nil {
		println(err)
		return
	}
	println(binary.BigEndian.Uint64(res[len(res)-8:len(res)]), caller.Gas)

	// function succ(uint256 n) public pure returns(uint256) {
	//     return n + 1;
	// }
	res, _, err = caller.Call(nil, -1, uint256.NewUint(12), "succ(uint256)", "6080604052348015600e575f5ffd5b506101928061001c5f395ff3fe608060405234801561000f575f5ffd5b5060043610610029575f3560e01c8063b6bb18641461002d575b5f5ffd5b610047600480360381019061004291906100a9565b61005d565b60405161005491906100e3565b60405180910390f35b5f60018261006b9190610129565b9050919050565b5f5ffd5b5f819050919050565b61008881610076565b8114610092575f5ffd5b50565b5f813590506100a38161007f565b92915050565b5f602082840312156100be576100bd610072565b5b5f6100cb84828501610095565b91505092915050565b6100dd81610076565b82525050565b5f6020820190506100f65f8301846100d4565b92915050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601160045260245ffd5b5f61013382610076565b915061013e83610076565b9250828201905080821115610156576101556100fc565b5b9291505056fea264697066735822122021f0977bf721504b70c595764f17246ab7a85c34b432f70b91902fe6acb8790864736f6c634300081d0033",
		uint256.NewUint(42),
	)
	if err != nil {
		println(err)
		return
	}
	println(binary.BigEndian.Uint64(res[len(res)-8:len(res)]), caller.Gas)
}
