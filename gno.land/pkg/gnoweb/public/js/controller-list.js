import{BaseController as d,debounce as g}from"./controller.js";var c=class a extends d{static STORAGE_KEY="gno_display_mode";static LOADING_CLASS="u-is-loading";connect(){if(this.initializeDOM({range:this.getTarget("range"),packagesCount:this.getTarget("packages-count"),realmsCount:this.getTarget("realms-count"),pureCount:this.getTarget("pure-count")}),this.currentFilter="",!this.getDOMElement("range")){console.warn("ListController: Range element not found");return}this._initializeItems(),this._restoreDisplayMode(),requestAnimationFrame(()=>{this.element?.classList.remove(a.LOADING_CLASS)})}_initializeItems(){let t=this.getDOMElement("range");if(!t)return;let e=this.getTargets("range-title");this.items=Array.from(t.children).map((r,n)=>{let s=e[n],i=this.getValue("type",r);return{element:r,title:(s?.textContent||"").toLowerCase(),type:i}}),this.sortedItems=[...this.items]}_restoreDisplayMode(){let t=localStorage.getItem(a.STORAGE_KEY);if(!t)return;let e=this.element?.querySelector(`input[name="display-mode"][value="${t}"]`);e&&!e.checked&&(e.checked=!0)}_updateCounts(t){let e=this.getDOMElement("packagesCount"),r=this.getDOMElement("realmsCount"),n=this.getDOMElement("pureCount"),s=t.reduce((o,u)=>(o[u.type]=(o[u.type]||0)+1,o),{}),i=s.realm||0,l=s.pure||0,m=i+l;e&&(e.textContent=m.toString()),r&&(r.textContent=i.toString()),n&&(n.textContent=l.toString())}_updateDOM(){let t=this.getDOMElement("range");if(!t)return;let e=this._filterItems(),r=document.createDocumentFragment();e.forEach(n=>r.appendChild(n.element)),t.textContent="",t.appendChild(r),this._updateCounts(e)}_debouncedSearch=g(t=>{this.currentFilter=t.toLowerCase(),this._updateDOM()},150);_sortItems(){this.sortedItems.reverse()}_filterItems(){return this.currentFilter?this.sortedItems.filter(t=>t.title.includes(this.currentFilter)):this.sortedItems}search(t){let e=t.target;this._debouncedSearch(e.value)}orderChange(t){this._sortItems(),this._updateDOM()}displayModeChange(t){let e=t.target;localStorage.setItem(a.STORAGE_KEY,e.value)}};export{c as ListController};
