function d(s,e=250){let t;return function(...n){t!==void 0&&clearTimeout(t),t=setTimeout(()=>{s.apply(this,n)},e)}}function u(s){return s.replace(/([$`"\\!|&;<>*?{}()])/g,"\\$1")}var o=class s{DOM;funcList;static SELECTORS={container:".js-help-view",func:"[data-func]",addressInput:"[data-role='help-input-addr']",cmdModeSelect:"[data-role='help-select-mode']"};constructor(){this.DOM={el:document.querySelector(s.SELECTORS.container),funcs:[],addressInput:null,cmdModeSelect:null},this.funcList=[],this.DOM.el?this.init():console.warn("Help: Main container not found.")}init(){let{el:e}=this.DOM;e&&(this.DOM.funcs=Array.from(e.querySelectorAll(s.SELECTORS.func)),this.DOM.addressInput=e.querySelector(s.SELECTORS.addressInput),this.DOM.cmdModeSelect=e.querySelector(s.SELECTORS.cmdModeSelect),this.funcList=this.DOM.funcs.map(t=>new l(t)),this.restoreAddress(),this.restoreMode(),this.bindEvents())}restoreValue(e,t,n){if(t){let r=localStorage.getItem(e);r&&(t.value=r,n(r))}}restoreAddress(){this.restoreValue("helpAddressInput",this.DOM.addressInput,e=>this.funcList.forEach(t=>t.updateAddr(e)))}restoreMode(){this.restoreValue("helpCmdMode",this.DOM.cmdModeSelect,e=>this.funcList.forEach(t=>t.updateMode(e)))}bindEvents(){let{addressInput:e,cmdModeSelect:t}=this.DOM,n=d(r=>{let a=r.value;localStorage.setItem("helpAddressInput",a),this.funcList.forEach(i=>i.updateAddr(a))},50);e?.addEventListener("input",()=>n(e)),t?.addEventListener("change",r=>{let i=r.target.value;localStorage.setItem("helpCmdMode",i),this.funcList.forEach(c=>c.updateMode(i))})}},l=class s{DOM;funcName;static SELECTORS={address:"[data-role='help-code-address']",args:"[data-role='help-code-args']",mode:"[data-code-mode]",paramInput:"[data-role='help-param-input']",functionLink:"[data-role='help-function-link']",send:"[data-role='help-code-send']",sendInput:"[data-role='help-send-input']"};constructor(e){this.DOM={el:e,addrs:Array.from(e.querySelectorAll(s.SELECTORS.address)),args:Array.from(e.querySelectorAll(s.SELECTORS.args)),modes:Array.from(e.querySelectorAll(s.SELECTORS.mode)),paramInputs:Array.from(e.querySelectorAll(s.SELECTORS.paramInput)),functionLink:e.querySelector(s.SELECTORS.functionLink),send:Array.from(e.querySelectorAll(s.SELECTORS.send)),sendInput:e.querySelector(s.SELECTORS.sendInput)},this.funcName=e.dataset.func||null,this.initializeArgs(),this.bindEvents()}static sanitizeArgsInput(e){let t=e.dataset.param||"",n=e.value.trim();return t||console.warn("sanitizeArgsInput: param is missing in arg input dataset."),{paramName:t,paramValue:n}}bindEvents(){let e=d((t,n)=>{t&&this.updateArg(t,n)},50);this.DOM.el.addEventListener("input",t=>{let n=t.target;if(n.dataset.role==="help-param-input"){let{paramName:r,paramValue:a}=s.sanitizeArgsInput(n);e(r,a)}}),this.DOM.el.addEventListener("change",t=>{let n=t.target;n.dataset.role==="help-send-input"&&this.updateSend(n.checked)})}initializeArgs(){this.DOM.paramInputs.forEach(e=>{let{paramName:t,paramValue:n}=s.sanitizeArgsInput(e);t&&this.updateArg(t,n)})}updateArg(e,t){let n=u(t);if(this.DOM.args.filter(r=>r.dataset.arg===e).forEach(r=>{r.textContent=n||""}),this.DOM.functionLink){let r=this.DOM.functionLink.getAttribute("href");if(!r){console.warn(`No href attribute found for function ${this.funcName}`);return}let a=r.replace(new RegExp(`(${e}=)[^&]*`),`$1${encodeURIComponent(t)}`);this.DOM.functionLink.setAttribute("href",a)}}updateSend(e){let t=e?this.DOM.sendInput?.dataset.send??"":"";this.DOM.send.forEach(n=>{n.textContent=t})}updateAddr(e){this.DOM.addrs.forEach(t=>{t.textContent=e.trim()||"ADDRESS"})}updateMode(e){this.DOM.modes.forEach(t=>{let n=t.dataset.codeMode===e;t.classList.toggle("inline",n),t.classList.toggle("hidden",!n),t.dataset.copyContent=n?`help-cmd-${this.funcName}`:""})}},h=()=>new o;export{h as default};
