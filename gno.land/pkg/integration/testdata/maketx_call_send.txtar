# load the package
loadpkg gno.land/r/foo/call_realm $WORK/realm

# start a new node
gnoland start

## user balance before realm send
gnokey query auth/accounts/$test1_user_addr
stdout '"coins": "9999998810700ugnot"'

## realm balance before realm send
gnokey query auth/accounts/g1x4ykzcqksj2hc5qpvr8kd9zaffkd82rvmzqup7
stdout '"coins": ""'

# call to realm with -send
gnokey maketx call -send 42ugnot -pkgpath gno.land/r/foo/call_realm -func GimmeMoney -gas-fee 1000000ugnot -gas-wanted 3000000 -broadcast -chainid=tendermint_test test1
stdout '("send: 42ugnot")'

## user balance after realm send
# reduced by -gas-fee AND -send
gnokey query auth/accounts/$test1_user_addr
stdout '"coins": "9999997810658ugnot"'

## realm balance after realm send
gnokey query auth/accounts/g1x4ykzcqksj2hc5qpvr8kd9zaffkd82rvmzqup7
stdout '"coins": "42ugnot"'


-- realm/realm.gno --
package call_realm

import "chain"

func GimmeMoney(cur realm) string {
	denoms, amounts := cur.Coins()
	coins := make(chain.Coins, len(denoms))
	for i := range coins {
		coins[i] = chain.Coin{Denom: denoms[i], Amount: amounts[i]}
	}
	return "send: " + coins.String()
}
