# aaa namespace
loadpkg gno.land/r/aaa/bbb/ccc $WORK
loadpkg gno.land/r/aaa/ccc/ddd $WORK
loadpkg gno.land/r/aaa $WORK

# bbb namespace
loadpkg gno.land/r/bbb/ccc $WORK
loadpkg gno.land/p/bbb/ccc/ppp $WORK
loadpkg gno.land/r/bbb/aaa $WORK
loadpkg gno.land/r/bbb0 $WORK

gnoland start

# query path for prefix
gnokey query vm/qpaths --data "gno.land/r/aaa"
stdout 'height: [1-9][0-9]*'
stdout 'data: gno.land/r/aaa'
stdout 'gno.land/r/aaa/bbb/ccc'
stdout 'gno.land/r/aaa/ccc/ddd'
! stderr '.+'

gnokey query vm/qpaths --data "gno.land/r/bbb"
stdout 'height: [1-9][0-9]*'
stdout 'data: gno.land/r/bbb/aaa'
stdout 'gno.land/r/bbb/ccc'
stdout 'gno.land/r/bbb0'
! stderr '.+'

gnokey query vm/qpaths --data "gno.land/r/bbb/"
stdout 'height: [1-9][0-9]*'
stdout 'data: gno.land/r/bbb/aaa'
stdout 'gno.land/r/bbb/ccc'
! stderr '.+'

# query path for namespace
gnokey query vm/qpaths --data "@bbb"
stdout 'height: [1-9][0-9]*'
stdout 'data: gno.land/p/bbb/ccc/ppp'
stdout 'gno.land/r/bbb/aaa'
stdout 'gno.land/r/bbb/ccc'
! stderr '.+'

# query path for namespace
gnokey query vm/qpaths --data "@bbb/ccc"
stdout 'height: [1-9][0-9]*'
stdout 'data: gno.land/p/bbb/ccc/ppp'
stdout 'gno.land/r/bbb/ccc'
! stderr '.+'

! gnokey query vm/qpaths --data "@invalid\\name"
cmp stdout invalid-name-qpaths.stdout.golden
cmp stderr invalid-name-qpaths.stderr.golden

gnokey query vm/qpaths --data "gno.land/r/ccc"
stdout 'height: [1-9][0-9]*'
stdout 'data: '
! stderr '.+'

gnokey query vm/qpaths?limit=5 --data "_"
stdout 'height: [1-9][0-9]*'
stdout 'data: bufio'
stdout 'bytes'
stdout 'chain'
stdout 'chain/banker'
stdout 'chain/params'
! stderr '.+'

gnokey query vm/qpaths --data "_/encoding"
stdout 'height: [1-9][0-9]*'
stdout 'data: encoding'
stdout 'encoding/base32'
stdout 'encoding/base64'
stdout 'encoding/binary'
stdout 'encoding/csv'
stdout 'encoding/hex'
! stderr '.+'

gnokey query vm/qpaths?limit=5 --data ""
stdout 'height: [1-9][0-9]*'
stdout 'data: bufio'
stdout 'bytes'
stdout 'chain'
stdout 'chain/banker'
stdout 'chain/params'
! stderr '.+'

-- main.gno --
package main

func main() { println("A") }
-- invalid-name-qpaths.stdout.golden --
Log: --= Error =--
Data: errors.FmtError{format:"invalid username format", args:[]interface {}(nil)}
Msg Traces:
--= /Error =--

-- invalid-name-qpaths.stderr.golden --
"gnokey" error: invalid username format
